function bricksAdminClassicEditor(){var e=document.getElementById("bricks-editor"),t=document.getElementById("postdivrich");if(e&&t){var i=document.createElement("button");i.type="button",i.id="switch-bricks",i.classList.add("wp-switch-editor","switch-bricks"),i.innerText=window.bricksData.title;var n=t.querySelector(".wp-editor-tabs");n&&n.appendChild(i),e.after(t),document.addEventListener("click",(function(i){"switch-bricks"===i.target.id?(i.preventDefault(),i.stopPropagation(),t.style.display="none",e.style.display="block",document.getElementById("bricks-editor-mode").value="bricks"):-1!==["content-html","content-tmce"].indexOf(i.target.id)&&(t.style.display="block",e.style.display="none",document.getElementById("bricks-editor-mode").value="wordpress")})),window.bricksData.renderWithBricks&&i.click()}}function bricksAdminImport(){var e=document.getElementById("bricks-admin-import-form");if(e){var t=document.querySelector("#wpbody-content .page-title-action");if(t){var i=document.getElementById("bricks-admin-template-tags");i&&t.after(i);var n=document.getElementById("bricks-admin-template-bundles");n&&t.after(n);var r=document.getElementById("bricks-admin-import-action");r&&t.after(r);var s=document.getElementById("bricks-admin-import-form-wrapper");t.after(s),document.querySelectorAll(".bricks-admin-import-toggle").forEach((function(e){e.addEventListener("click",(function(){s.style.display="block"===s.style.display?"none":"block"}))})),e.addEventListener("submit",(function(t){t.preventDefault();for(var i=new FormData(e),n=document.getElementById("bricks_import_files").files,r=0;r<n.length;r++){var s=n[r];i.append("files["+r+"]",s)}jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:i,processData:!1,contentType:!1,success:function(e){location.reload()}})}))}}}function bricksAdminSaveLicenseKey(){var e=document.getElementById("bricks-license-key-form");if(e){var t=e.action.value,i=e.nonce.value,n=e.querySelector("input[type=submit]");e.addEventListener("submit",(function(r){r.preventDefault(),n.disabled=!0;var s=e.license_key.value;jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:t,licenseKey:s,nonce:i},success:function(i){"bricks_deactivate_license"===t?location.reload():"bricks_activate_license"===t&&(i.success?(i.data.hasOwnProperty("message")&&(e.querySelector(".success-message").innerHTML=i.data.message),setTimeout((()=>{location.reload()}),1e3)):(n.disabled=!1,i.data.hasOwnProperty("message")&&(e.querySelector(".error-message").innerHTML=i.data.message)))}})}))}}function bricksAdminToggleLicenseKey(){var e=document.getElementById("bricks-toggle-license-key");e&&e.addEventListener("click",(function(e){e.preventDefault(),e.target.classList.contains("dashicons-hidden")?(e.target.classList.remove("dashicons-hidden"),e.target.classList.add("dashicons-visibility"),e.target.previousElementSibling.type="text"):(e.target.classList.remove("dashicons-visibility"),e.target.classList.add("dashicons-hidden"),e.target.previousElementSibling.type="password")}))}function bricksAdminSettings(){var e=document.querySelector("#bricks-settings");if(e){for(var t=document.querySelectorAll("#bricks-settings-tabs-wrapper a"),i=e.querySelectorAll("table"),n=0;n<t.length;n++)t[n].addEventListener("click",(function(e){e.preventDefault();var i=e.target.getAttribute("data-tab-id");if(i){location.hash=i,window.scrollTo({top:0});for(var n=0;n<t.length;n++)t[n].classList.remove("nav-tab-active");e.target.classList.add("nav-tab-active"),u(i)}}));var r=location.hash.replace("#","");if(r){var s=document.querySelector('[data-tab-id="'+r+'"]');s&&s.click()}var a=e.querySelector(".submit-wrapper"),c=e.querySelector(".spinner.saving");if(e){e.addEventListener("submit",(function(e){e.preventDefault()}));var o=e.querySelector('input[name="save"]');o&&o.addEventListener("click",(function(t){a&&a.remove(),c&&c.classList.add("is-active"),jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_save_settings",formData:jQuery(e).serialize(),nonce:window.bricksData.nonce},success:function(e){let t=window.location.hash;window.location.href=window.location.search+=`&bricks_notice=settings_saved${t}`}})}));var d=e.querySelector('input[name="reset"]');d&&d.addEventListener("click",(function(e){confirm(bricksData.cofirmResetSettings)&&(a&&a.remove(),c&&c.classList.add("is-active"),jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_reset_settings",nonce:window.bricksData.nonce},success:function(){window.location.href=window.location.search+="&bricks_notice=settings_resetted"}}))}));var l=e.querySelector('input[name="executeCodeEnabled"]');l&&l.addEventListener("click",(function(t){e.querySelectorAll('input[name^="executeCodeCapabilities"').forEach((function(e){e.disabled=!t.target.checked}))}))}}function u(e){document.getElementById(e);for(var t=0;t<i.length;t++){var n=i[t];n.getAttribute("id")===e?n.classList.add("active"):n.classList.remove("active")}}}function bricksAdminGenerateCssFiles(){button=document.querySelector("#bricks-css-loading-generate button"),button&&button.addEventListener("click",(function(e){e.preventDefault(),button.setAttribute("disabled","disabled"),button.classList.add("wait");var t=document.querySelector("#bricks-css-loading-generate .results");if(t){t.classList.remove("hide");var i=t.querySelector("ul"),n=t.querySelector(".count"),r=t.querySelector(".done");i.innerHTML="",n.innerHTML=0,r&&r.remove();var s=t.querySelector(".end");s&&s.remove()}jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_get_css_files_list",nonce:bricksData.nonce},success:function(e){bricksAdminGenerateCssFile(0,i,n,e.data)}})}))}function bricksAdminCodeReview(){let e="individual";const t=document.querySelector(".bricks-code-review-description"),i=document.querySelector(".bricks-code-review-action.show-all"),n=document.querySelector(".bricks-code-review-action.individual"),r=document.querySelectorAll(".bricks-code-review-item"),s=document.querySelector(".bricks-code-review-action.prev"),a=document.querySelector(".bricks-code-review-action.next"),c=document.querySelectorAll(".bricks-code-review-item-check");if(!i||!r||!n)return;const o=(e="up")=>{let t=document.querySelector(".bricks-code-review-total-reviewed"),i=t.innerText;i=i?parseInt(i):1,"up"===e?i++:i--,t&&(t.innerText=i)};i.addEventListener("click",(function(c){c.preventDefault(),e="all",t.classList.add("action-hide"),i.classList.add("action-hide"),n.classList.remove("action-hide"),s.classList.add("action-hide"),a.classList.add("action-hide"),r.forEach((function(e){e.classList.remove("item-hide")}))})),n.addEventListener("click",(function(c){c.preventDefault(),e="individual",t.classList.remove("action-hide"),n.classList.add("action-hide"),i.classList.remove("action-hide"),s.classList.remove("action-hide"),a.classList.remove("action-hide"),r.forEach((function(e){e.classList.add("item-hide")}));let o=document.querySelector(".bricks-code-review-item.item-current");o&&o.classList.remove("item-hide")})),s.addEventListener("click",(function(e){e.preventDefault();let t=document.querySelector(".bricks-code-review-item.item-current"),i=t.previousElementSibling;i&&(t.classList.remove("item-current"),t.classList.add("item-hide"),i.classList.add("item-current"),i.classList.remove("item-hide"),o("down"))})),a.addEventListener("click",(function(e){e.preventDefault();let t=document.querySelector(".bricks-code-review-item.item-current"),i=t.nextElementSibling;i&&(t.classList.remove("item-current"),t.classList.add("item-hide"),i.classList.add("item-current"),i.classList.remove("item-hide"),o("up"))})),c.length&&c.forEach((function(t){t.addEventListener("click",(function(i){i.preventDefault();let n=t.closest(".bricks-code-review-item");n&&(n.classList.add("item-marked"),o(),"individual"===e&&setTimeout((()=>{a.click()}),400))}))}))}function bricksAdminBreakpointsRegenerateCssFiles(){let e=document.getElementById("breakpoints-regenerate-css-files");if(!e)return;let t=e.querySelector("i");e.addEventListener("click",(function(i){i.preventDefault(),jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_regenerate_bricks_css_files",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait"),t.classList.add("hide")},success:function(i){e.removeAttribute("disabled"),e.classList.remove("wait"),t.classList.remove("hide")}})}))}function bricksAdminGenerateCssFile(e,t,i,n){return jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_regenerate_css_file",data:n[e],index:e},success:function(e){var n=!!e.data.hasOwnProperty("file_name")&&e.data.file_name;if(n){var r="",s=i?parseInt(i.innerText):0;Array.isArray(n)?n.forEach((function(e){r+="<li>"+e+"</li>",s++})):(r+="<li>"+n+"</li>",s++),e.success||(r=r.replace("<li>",'<li class="error">')),t&&t.insertAdjacentHTML("afterbegin",r),i&&(i.innerText=s)}}}).then((function(r){if(e===n.length){var s=document.querySelector("#bricks-css-loading-generate button");s.removeAttribute("disabled"),s.classList.remove("wait");var a=document.querySelector("#bricks-css-loading-generate .info");a&&a.remove(),t&&t.insertAdjacentHTML("beforebegin",'<div class="done">... THE END :)</div>')}else bricksAdminGenerateCssFile(e+1,t,i,n)}))}function bricksAdminRunConverter(){var e=document.getElementById("bricks-run-converter");e&&e.addEventListener("click",(function(t){t.preventDefault();let i={action:"bricks_get_converter_items",nonce:bricksData.nonce,convert:[]};document.getElementById("convert_element_ids_classes").checked&&i.convert.push("elementClasses"),document.getElementById("convert_container").checked&&i.convert.push("container"),document.getElementById("add_position_relative").checked&&i.convert.push("addPositionRelative"),document.getElementById("entry_animation_to_interaction").checked&&i.convert.push("entryAnimationToInteraction"),i.convert.length&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:i,beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:e=>{console.info("bricks_get_converter_items",e.data);bricksAdminConvert(0,e.data.items,e.data.convert)}})}))}function bricksAdminConvert(e,t,i){return jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_run_converter",nonce:bricksData.nonce,data:t[e],convert:i},success:function(n){var r=document.getElementById("bricks-run-converter"),s=r.parentNode.querySelector(".results");if(s)s&&0===e&&(s.querySelector("ul").innerHTML="");else{(s=document.createElement("div")).classList.add("results");var a=document.createElement("ul");s.appendChild(a),r.parentNode.appendChild(s)}var c,o=!!n.data.hasOwnProperty("label")&&n.data.label;o&&((c=document.createElement("li")).innerHTML=o,s.querySelector("ul").prepend(c));(console.warn("run_converter",e,o,n.data),e===t.length)?(r.removeAttribute("disabled"),r.classList.remove("wait"),(c=document.createElement("li")).classList.add("done"),c.innerText="... THE END :)",s.querySelector("ul").prepend(c)):bricksAdminConvert(e+1,t,i)}})}function bricksTemplateShortcodeCopyToClipboard(){var e=document.querySelectorAll(".bricks-copy-to-clipboard");e&&e.forEach((function(e){e.addEventListener("click",(function(t){if(navigator.clipboard){if(!window.isSecureContext)return void alert("Clipboard API rejected: Not in secure context (HTTPS)");if(e.classList.contains("copied"))return void t.preventDefault();var i=e.value,n=e.getAttribute("data-success");navigator.clipboard.writeText(i),e.value=n,e.classList.add("copied"),setTimeout((function(){e.value=i,e.classList.remove("copied")}),2e3)}}))}))}function bricksDismissHttpsNotice(){setTimeout((()=>{let e=document.querySelector(".brxe-https-notice .notice-dismiss");e&&e.addEventListener("click",(function(){jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_dismiss_https_notice",nonce:bricksData.nonce}})}))}),400)}function bricksDropFormSubmissionsTable(){let e=document.getElementById("bricks-drop-form-db");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.confirmDropFormSubmissionsTable)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_form_submissions_drop_table",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(t.data.message),location.reload()}})}))}function bricksResetFormSubmissionsTable(){let e=document.getElementById("bricks-reset-form-db");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.confirmResetFormSubmissionsTable)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_form_submissions_reset_table",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(t.data.message),location.reload()}})}))}function bricksDeleteFormSubmissionsByFormId(){if(!document.body.classList.contains("bricks_page_bricks-form-submissions"))return;let e=document.querySelectorAll(".column-actions [data-form-id]");for(var t=0;t<e.length;t++){let i=e[t];i.addEventListener("click",(function(e){e.preventDefault();let t=i.getAttribute("data-form-id");confirm(bricksData.confirmResetFormSubmissionsFormId.replace("[form_id]",`"${t}"`))&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_form_submissions_delete_form_id",nonce:bricksData.nonce,formId:t},beforeSend:()=>{i.setAttribute("disabled","disabled"),i.classList.add("wait")},success:function(e){i.removeAttribute("disabled"),i.classList.remove("wait"),alert(e.data.message),location.reload()}})}))}}function bricksDismissInstagramAccessTokenNotice(){setTimeout((()=>{let e=document.querySelector(".brxe-instagram-token-notice .notice-dismiss");e&&e.addEventListener("click",(function(){jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_dismiss_instagram_access_token_notice",nonce:bricksData.nonce}})}))}),400)}function bricksRemoteTemplateUrls(){let e=document.getElementById("add-remote-template-button");e&&e.addEventListener("click",(function(e){e.preventDefault();let t=document.querySelectorAll(".remote-template-wrapper"),i=t[t.length-1];if(!i)return;let n=i.cloneNode(!0);n.querySelectorAll("label").forEach((e=>{e.setAttribute("for",e.getAttribute("for").replace(/\[(\d+)\]/,(function(e,t){return"["+(parseInt(t)+1)+"]"})))})),n.querySelectorAll("input").forEach((e=>{e.value="",e.name=e.name.replace(/\[(\d+)\]/,(function(e,t){return"["+(parseInt(t)+1)+"]"})),e.id=e.id.replace(/\[(\d+)\]/,(function(e,t){return"["+(parseInt(t)+1)+"]"}))})),i.after(n)}))}function bricksDeleteTemplateScreenshots(){let e=document.getElementById("delete-template-screenshots-button");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.confirmDeleteTemplateScreenshots)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_delete_template_screenshots",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(t.data.message),t.success&&location.reload()}})}))}function bricksReindexFilters(){let e=document.getElementById("bricks-reindex-filters"),t=document.querySelector(".indexer-progress"),i=document.getElementById("bricks-run-index-job");e&&t&&i&&e.addEventListener("click",(function(n){n.preventDefault(),confirm(bricksData.confirmReindexFilters)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_reindex_query_filters",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(n){e.removeAttribute("disabled"),e.classList.remove("wait"),n.success?(t.innerText=n.data.message,setTimeout((()=>{i.setAttribute("data-no-confirm","true"),i.click()}),500)):console.error("bricks_reindex_query_filters:error",n.data)}})}))}function bricksRunIndexJob(){let e=document.getElementById("bricks-run-index-job"),t=document.querySelector(".indexer-progress"),i=!!e&&e.querySelector("i"),n=document.getElementById("bricks-remove-jobs-wrapper"),r=document.getElementById("bricks-remove-index-jobs"),s=document.getElementById("bricks-query-filter-td"),a=!1;if(!(e&&t&&i&&r&&n))return;const c=()=>{jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_run_index_job",nonce:bricksData.nonce},success:function(r){let s=r?.data?.progress||!1,o=r?.data?.pending||!1;t&&s&&(t.innerHTML=s),0==o||a?(e.removeAttribute("disabled"),e.classList.remove("wait"),i.classList.remove("hide"),a&&o>0&&n.classList.remove("hide")):setTimeout((()=>{c()}),3e3)},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait"),n.classList.add("hide")}})};e.classList.contains("wait")&&c(),e.addEventListener("click",(function(t){if((t.preventDefault(),!e.getAttribute("data-no-confirm"))&&!confirm(bricksData.confirmTriggerIndexJob))return;c(),e.removeAttribute("data-no-confirm"),i.classList.add("hide"),n.classList.add("hide")})),r.addEventListener("click",(function(e){e.preventDefault(),confirm(bricksData.confirmRemoveAllIndexJobs)&&(a=!0,jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_remove_all_index_jobs",nonce:bricksData.nonce},success:function(e){e.success&&setTimeout((()=>{alert(e.data.message),location.reload()}),1e4)},beforeSend:()=>{r.setAttribute("disabled","disabled"),r.classList.add("wait"),s.classList.add("blocking");let e=document.createElement("div");e.classList.add("blocking-info-wrapper"),e.innerHTML=`<p class="message info">${bricksData.removingIndexJobsInfo}</p>`,s.appendChild(e)}}))}))}function bricksRegenerateCodeSignatures(){let e=document.getElementById("bricks-regenerate-code-signatures");e&&e.addEventListener("click",(function(t){t.preventDefault(),confirm(bricksData.confirmRegenerateCodeSignatures)&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_regenerate_code_signatures",nonce:bricksData.nonce},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:function(t){e.removeAttribute("disabled"),e.classList.remove("wait"),alert(t.data.message),t.success?location.reload():console.error("bricks_regenerate_code_element_signatures:error",t.data)}})}))}function bricksAdminCodeReviewFilter(){let e=document.getElementById("code-review-filter");e&&e.addEventListener("change",(e=>{let t=new URL(window.location.href);t.searchParams.set("code-review",e.target.value),window.location.href=t.toString()}))}function bricksAdminMaintenanceTemplateListener(){let e=document.getElementById("maintenance-template"),t=document.getElementById("maintenanceRenderFooter")?.closest(".setting-wrapper"),i=document.getElementById("maintenanceRenderHeader")?.closest(".setting-wrapper");function n(){""===e.value?(t.style.display="none",i.style.display="none"):(t.style.display="block",i.style.display="block")}e&&t&&i&&(n(),e.addEventListener("change",n))}function bricksTemplateThumbnailAddScrollAnimation(){document.querySelectorAll(".template_thumbnail a").forEach((e=>{const t=e.querySelector("img");function i(){const i=t.getBoundingClientRect().height,r=e.getBoundingClientRect().height;if(i>r){const s=r-i,a=function(e){const t=2e3,i=200;return Math.abs(e)*t/i}(s);e.classList.add("scroll"),e.addEventListener("mouseenter",(()=>{n(t,0,s,a)})),e.addEventListener("mouseleave",(()=>{const e=parseFloat(t.style.top)||s;n(t,e,0,a)}))}}function n(e,t,i,n){let r,s;cancelAnimationFrame(r),r=requestAnimationFrame((function a(c){s||(s=c);const o=c-s,d=Math.min(o/n,1);e.style.top=t+(i-t)*d+"px",d<1&&(r=requestAnimationFrame(a))}))}t.addEventListener("load",i),t.complete&&i()}))}function bricksAdminAuthUrlBehaviorListener(){let e=document.getElementById("wp_auth_url_behavior"),t=document.getElementById("wp_auth_url_redirect_page_wrapper");function i(){"custom"===e.value?t.style.display="block":t.style.display="none"}e&&t&&(i(),e.addEventListener("change",i))}function bricksAdminWooSettings(){let e=document.getElementById("woocommerceAjaxErrorAction"),t=document.getElementById("wooAjaxErrorScrollToNotice");e&&t&&e.addEventListener("change",(function(e){"notice"===e.target.value?t.classList.remove("hide"):t.classList.add("hide")}))}document.addEventListener("DOMContentLoaded",(function(e){bricksAdminClassicEditor(),bricksAdminImport(),bricksAdminSaveLicenseKey(),bricksAdminToggleLicenseKey(),bricksAdminSettings(),bricksAdminRunConverter(),bricksAdminBreakpointsRegenerateCssFiles(),bricksAdminGenerateCssFiles(),bricksAdminCodeReview(),bricksAdminCodeReviewFilter(),bricksTemplateShortcodeCopyToClipboard(),bricksDismissHttpsNotice(),bricksDismissInstagramAccessTokenNotice(),bricksDropFormSubmissionsTable(),bricksResetFormSubmissionsTable(),bricksDeleteFormSubmissionsByFormId(),bricksRemoteTemplateUrls(),bricksDeleteTemplateScreenshots(),bricksReindexFilters(),bricksRunIndexJob(),bricksRegenerateCodeSignatures(),bricksTemplateThumbnailAddScrollAnimation(),bricksAdminMaintenanceTemplateListener(),bricksAdminAuthUrlBehaviorListener(),bricksAdminWooSettings();let t=document.querySelector(".wp-list-table-container"),i=document.querySelector(".tablenav.top"),n=document.querySelector(".tablenav.bottom");t&&i&&t.parentNode.insertBefore(i,t),t&&n&&t.parentNode.insertBefore(n,t.nextSibling);let r=document.getElementById("bricks-form-submissions"),s=!!r&&r.querySelector(".search-box input[type=search]");s&&(s.placeholder=window.bricksData?.formSubmissionsSearchPlaceholder)}));
